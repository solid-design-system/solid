steps:
  - task: AzureCLI@2
    displayName: 'Purge CDN from step above'
    inputs:
      azureSubscription: 'Workload CI/CD Service Connection (S_STATICCONTENT_PROD)'
      scriptType: 'bash'
      scriptLocation: 'inlineScript'
      inlineScript: |
        if [[ $deployment != "none" ]]; then
          # Purge all folders
          set -x
          az cdn endpoint purge \
            --resource-group rg-staticcontent-prod-frontend-cdn \
            --profile-name cdn-staticcontent-prod-frontend-cdn \
            --name "fe-solid-design-system-prod" \
            --content-paths "/*" \
            --no-wait
          set +x

          # Purge version folder
          # set -x
          # az cdn endpoint purge \
          #   --resource-group rg-staticcontent-prod-frontend-cdn \
          #   --profile-name cdn-staticcontent-prod-frontend-cdn \
          #   --name "fe-solid-design-system-prod" \
          #   --content-paths "/$(version)/*" \
          #   --no-wait
          # set +x

          # Purge patch-wildcard folder
          # set -x
          # az cdn endpoint purge \
          #   --resource-group rg-staticcontent-prod-frontend-cdn \
          #   --profile-name cdn-staticcontent-prod-frontend-cdn \
          #   --name "fe-solid-design-system-prod" \
          #   --content-paths "/$(patchWildcardPath)/*" \
          #   --no-wait
          # set +x

          # Purge major-wildcard folder
          # set -x
          # az cdn endpoint purge \
          #   --resource-group rg-staticcontent-prod-frontend-cdn \
          #   --profile-name cdn-staticcontent-prod-frontend-cdn \
          #   --name "fe-solid-design-system-prod" \
          #   --content-paths "/$(majorWildcardPath)/*" \
          #   --no-wait
          # set +x

          # Purge minor-wildcard folder
          # set -x
          # az cdn endpoint purge \
          #   --resource-group rg-staticcontent-prod-frontend-cdn \
          #   --profile-name cdn-staticcontent-prod-frontend-cdn \
          #   --name "fe-solid-design-system-prod" \
          #   --content-paths "/$(minorWildcardPath)/*" \
          #   --no-wait
          # set +x
        fi
