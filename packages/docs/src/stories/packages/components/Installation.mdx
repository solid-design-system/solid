import { Markdown, Meta } from '@storybook/addon-docs/blocks';
import Readme from '../../../../../components/README.md?raw';
import '../../../../../components/src/components/accordion/accordion';
import '../../../../../components/src/components/tab-group/tab-group';
import '../../../../../components/src/components/tab/tab';
import '../../../../../components/src/components/tab-panel/tab-panel';
import '../../../../../components/src/components/notification/notification';

<Meta title="Packages/Components/Installation" />

# Installation

You can load Solid Components via CDN or by installing it locally.

## Prerequisites

### Fonts

Solid Components don't provide any fonts, you have to include them yourself.
We recommend using the CDN of `global-resources` by the CMS project.
(Please reach out to brand department if you want to self-host the font.)
The following CSS gives you a jump start. Please make sure to change `latest`
to a concrete package version you want to use.

<sd-notification variant="info" duration="Infinity" toast-stack="top-right" open="true">
    <div class="slot sd-prose">When using this jump start, ensure compliance with the SDS license terms, and verify that your use case is explicitly authorized to use the custom brand font Frutiger Neue for UI.</div>
</sd-notification>

<sd-accordion summary="Example CSS">

```css
body {
  font-family:
    'Frutiger Neue',
    ui-sans-serif,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    'Helvetica Neue',
    Arial,
    'Noto Sans',
    sans-serif,
    'Apple Color Emoji',
    'Segoe UI Emoji',
    'Segoe UI Symbol',
    'Noto Color Emoji';
}

@font-face {
  font-family: 'Frutiger Neue';
  font-style: normal;
  font-weight: 400;
  src: url('https://global-resources.fe.union-investment.de/latest/fonts/frutiger-neue/FrutigerNeuefuerUIWebW05-Bk.woff2')
    format('woff2');
}

@font-face {
  font-family: 'Frutiger Neue';
  font-style: italic;
  font-weight: 400;
  src: url('https://global-resources.fe.union-investment.de/latest/fonts/frutiger-neue/FrutigerNeuefuerUIWebW05-BkIt.woff2')
    format('woff2');
}

@font-face {
  font-family: 'Frutiger Neue';
  font-style: normal;
  font-weight: 600;
  src: url('https://global-resources.fe.union-investment.de/latest/fonts/frutiger-neue/FrutigerNeuefuerUIWebW05-Bd.woff2')
    format('woff2');
}

@font-face {
  font-family: 'Frutiger Neue';
  font-style: italic;
  font-weight: 600;
  src: url('https://global-resources.fe.union-investment.de/latest/fonts/frutiger-neue/FrutigerNeuefuerUIWebW05-BdIt.woff2')
    format('woff2');
}
```

</sd-accordion>

To improve font rendering, the following CSS has to be added to your project as well:

<sd-accordion summary="Example CSS">

```css
/**
  * Render Neue Frutiger correctly.
  */

:root {
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-text-size-adjust: 100%;
  line-height: 1.5;
  font-size: 16px;
}
```

</sd-accordion>

### Normalizing browser styles

We recommend using [normalize.css](https://necolas.github.io/normalize.css/) or similar.
This will handle cross-browser inconsistencies and set furthermore some improvements,
e. g. regarding improved line-heights for `<sub>` and `<sup>` elements.
If you don't want to use normalize.css, you should at least reset
the line-heights for `<sub>` and `<sup>` elements, as shown below.

<sd-accordion summary="Example CSS">

```css
/**
  * Prevent `sub` and `sup` elements from affecting the line height in
  * all browsers.
  */

sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}
```

</sd-accordion>

## Versioned vs. unversioned components

When using web components from Solid Design System in microfrontends, versioned components are always recommended. Including version numbers in component names provides more control over updates and prevents collisions when different versions of the same component are used simultaneously.

<sd-tab-group>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="unversioned"> Unversioned </sd-tab>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="versioned"> Versioned </sd-tab>
  <sd-tab-panel name="unversioned">
    ```html
    <sd-button></sd-button>
    ```
  </sd-tab-panel>
  <sd-tab-panel name="versioned">
    ```html
    <sd-%DASHED-COMPONENTS-VERSION%-button></sd-%DASHED-COMPONENTS-VERSION%-button>
    ```
  </sd-tab-panel>
</sd-tab-group>

Keep the following in mind for nested components:

- _Slotted components_, which are added by your app or website, are not automatically versioned. You need to version them yourself if necessary.
- _Nested components_, which are generated by the component itself, are automatically versioned (e.g., `sd-%DASHED-COMPONENTS-VERSION%-button` will generate an `sd-%DASHED-COMPONENTS-VERSION%-spinner` when in the loading state).

## CDN Installation

### Bundle

The bundle registers all Solid Components in a single file. If you're using many Solid Components, this is the most performant way to load and hydrate them. Still, you should ensure that other applications are not loading components with the same tag names via an additional CDN or npm package. This therefore makes most sense in e. g. a CMS context.
You can use the following script tag to load all components:

<sd-tab-group>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="unversioned"> Unversioned </sd-tab>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="versioned"> Versioned </sd-tab>
  <sd-tab-panel name="unversioned">
    ```html
    <link
      rel="stylesheet"
      href="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn/solid-components.css"
    />
    <script
      type="module"
      src="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn/solid-components.bundle.js"
    ></script>
    ```
  </sd-tab-panel>
  <sd-tab-panel name="versioned">
    ```html
    <link
      rel="stylesheet"
      href="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn-versioned/solid-components.css"
    />
    <script
      type="module"
      src="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn-versioned/solid-components.bundle.js"
    ></script>
    ```
  </sd-tab-panel>
</sd-tab-group>

### ESM

The CDN loader registers all Solid elements up front. Note that, if you're only using a handful of components, it could be more efficient [cherry pick](#cherry-picking) components if you want to load specific ones up front.

<sd-tab-group>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="unversioned">Unversioned</sd-tab>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="versioned">Versioned</sd-tab>
  <sd-tab-panel name="unversioned">
    ```html
    <link
      rel="stylesheet"
      href="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn/solid-components.css"
    />
    <script
      type="module"
      src="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn/solid-components.js"
    ></script>
    ```
  </sd-tab-panel>
  <sd-tab-panel name="versioned">
    ```html
    <link
      rel="stylesheet"
      href="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn-versioned/solid-components.css"
    />
    <script
      type="module"
      src="https://solid-design-system.fe.union-investment.de/components/%COMPONENTS-VERSION%/cdn-versioned/solid-components.js"
    ></script>
    ```
  </sd-tab-panel>
</sd-tab-group>

## npm installation

If you don't want to use the CDN, you can install Solid Components from npm with the following command.

```bash
npm install @solid-design-system/components
```

It's up to you to make the source files available to your app. One way to do this is to create a route in your app called `/solid` that serves static files from `node_modules/@solid-design-system/components`.

Once you've done that, add the following tags to your page. Make sure to update `href` and `src` so they point to the route you created.

<sd-tab-group>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="unversioned">Unversioned</sd-tab>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="versioned">Versioned</sd-tab>
  <sd-tab-panel name="unversioned">
    ```html
    <link rel="stylesheet" href="/solid/dist/solid-components.css" />
    <script type="module" src="/solid/dist/solid-components.js"></script>
    ```
  </sd-tab-panel>
  <sd-tab-panel name="versioned">
    ```html
    <link rel="stylesheet" href="/solid/dist-versioned/solid-components.css" />
    <script type="module" src="/solid/dist-versioned/solid-components.js"></script>
    ```
  </sd-tab-panel>
</sd-tab-group>

Alternatively, [you can use a bundler](#bundling).

## Cherry Picking

Cherry picking can be done from [the CDN](#cdn-installation) or from [npm](#npm-installation). This approach will load only the components you need up front, while limiting the number of files the browser has to download. The disadvantage is that you need to import each individual component.

Here's an example that loads only the button component. Again, if you're not using a module resolver, you'll need to adjust the path to point to the folder Solid is in.

<sd-tab-group>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="unversioned">Unversioned</sd-tab>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="versioned">Versioned</sd-tab>
  <sd-tab-panel name="unversioned">
  ```html
  <link rel="stylesheet" href="/path/to/solid/dist/solid-components.css" />
  <script type="module">
    import '@solid-design-system/components/dist/components/button/button.js';

    // <sd-button> is ready to use!

  </script>
  ```
  </sd-tab-panel>
  <sd-tab-panel name="versioned">
  ```html
    <link rel="stylesheet" href="/path/to/solid/dist-versioned/solid-components.css" />
  <script type="module">
    import '@solid-design-system/components/dist-versioned/components/button/button.js';

    // <sd-%DASHED-COMPONENTS-VERSION%-button> is ready to use!

  </script>
  ```
  </sd-tab-panel>
</sd-tab-group>

You can copy and paste the code to import a component from the "Importing" section of the component's documentation. Note that some components have dependencies that are automatically imported when you cherry pick. If a component has dependencies, they will be listed in the "Dependencies" section of its docs.

> Never cherry pick components or utilities from `solid-components.js` as this will cause the browser to load the entire library. Instead, cherry pick from specific modules as shown above.

> You will see files named `chunk.[hash].js` in the `chunks` directory. Never import these files directly, as they are generated and change from version to version.

## Bundling

Solid Components are distributed as a collection of standard ES modules that [all modern browsers can understand](https://caniuse.com/es6-module). However, importing a lot of modules can result in a lot of HTTP requests and potentially longer load times. Using a CDN can alleviate this, but some users may wish to further optimize their imports with a bundler.

To use Solid with a bundler, first install Solid along with your bundler of choice.

```bash
npm install @solid-design-system/components
```

Now it's time to configure your bundler. Configurations vary for each tool, but here are some examples using Shoelace, that help you get started.

- [Example webpack config](https://github.com/shoelace-style/webpack-example/blob/master/webpack.config.js)
- [Example Rollup config](https://github.com/shoelace-style/rollup-example/blob/master/rollup.config.js)

Once your bundler is configured, you'll be able to import Solid components and utilities.

<sd-tab-group>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="unversioned">Unversioned</sd-tab>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="versioned">Versioned</sd-tab>
  <sd-tab-panel name="unversioned">
  ```js
import '@solid-design-system/components/dist/solid-components.css';
import '@solid-design-system/components/dist/components/button/button.js';
import '@solid-design-system/components/dist/components/icon/icon.js';
import '@solid-design-system/components/dist/components/input/input.js';
// <sd-button>, <sd-icon> and <sd-input> are ready to use!
```

  </sd-tab-panel>
  <sd-tab-panel name="versioned">
  ```js
import '@solid-design-system/components/dist-versioned/solid-components.css';
import '@solid-design-system/components/dist-versioned/components/button/button.js';
import '@solid-design-system/components/dist-versioned/components/icon/icon.js';
import '@solid-design-system/components/dist-versioned/components/input/input.js';
// <sd-button>, <sd-icon> and <sd-input> are ready to use!
```

  </sd-tab-panel>
</sd-tab-group>

> Component modules include side effects for registration purposes. Because of this, importing directly from `@solid-design-system/components` may result in a larger bundle size than necessary. For optimal tree shaking, always cherry pick, i.e. import components and utilities from their respective files, as shown above.

## The difference between CDN and npm

CDN links all start with `/cdn/<path>` and npm imports use `/dist/<path>`. The `/cdn` files are bundled separately from the `/dist` files. The `/cdn` files come pre-bundled, which means all dependencies are inlined so you do not need to worry about loading additional libraries. The `/dist` files **DO NOT** come pre-bundled, allowing your bundler of choice to more efficiently deduplicate dependencies, resulting in smaller bundles and optimal code sharing.

TL;DR:

<sd-tab-group>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="unversioned">Unversioned</sd-tab>
  {/* prettier-ignore */}
  <sd-tab slot="nav" panel="versioned">Versioned</sd-tab>
  <sd-tab-panel name="unversioned">

    - `@solid-design-system/components/cdn` is for CDN users
    - `@solid-design-system/components/dist` is for npm users

  </sd-tab-panel>
  <sd-tab-panel name="versioned">

    - `@solid-design-system/components/cdn-versioned` is for CDN users
    - `@solid-design-system/components/dist-versioned` is for npm users

  </sd-tab-panel>
</sd-tab-group>
