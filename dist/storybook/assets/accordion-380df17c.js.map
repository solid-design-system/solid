{"version":3,"file":"accordion-380df17c.js","sources":["../../../src/internal/animate.ts","../../../src/utilities/animation-registry.ts","../../../src/internal/event.ts","../../../src/components/accordion/accordion.ts"],"sourcesContent":["/**\n * Animates an element using keyframes. Returns a promise that resolves after the animation completes or gets canceled.\n */\nexport function animateTo(el: HTMLElement, keyframes: Keyframe[], options?: KeyframeAnimationOptions) {\n  return new Promise(resolve => {\n    if (options?.duration === Infinity) {\n      throw new Error('Promise-based animations must be finite.');\n    }\n\n    const animation = el.animate(keyframes, {\n      ...options,\n      duration: prefersReducedMotion() ? 0 : options!.duration\n    });\n\n    animation.addEventListener('cancel', resolve, { once: true });\n    animation.addEventListener('finish', resolve, { once: true });\n  });\n}\n\n/** Parses a CSS duration and returns the number of milliseconds. */\nexport function parseDuration(delay: number | string) {\n  delay = delay.toString().toLowerCase();\n\n  if (delay.indexOf('ms') > -1) {\n    return parseFloat(delay);\n  }\n\n  if (delay.indexOf('s') > -1) {\n    return parseFloat(delay) * 1000;\n  }\n\n  return parseFloat(delay);\n}\n\n/** Tells if the user has enabled the \"reduced motion\" setting in their browser or OS. */\nexport function prefersReducedMotion() {\n  const query = window.matchMedia('(prefers-reduced-motion: reduce)');\n  return query.matches;\n}\n\n/**\n * Stops all active animations on the target element. Returns a promise that resolves after all animations are canceled.\n */\nexport function stopAnimations(el: HTMLElement) {\n  return Promise.all(\n    el.getAnimations().map(animation => {\n      return new Promise(resolve => {\n        const handleAnimationEvent = requestAnimationFrame(resolve);\n\n        animation.addEventListener('cancel', () => handleAnimationEvent, { once: true });\n        animation.addEventListener('finish', () => handleAnimationEvent, { once: true });\n        animation.cancel();\n      });\n    })\n  );\n}\n\n/**\n * We can't animate `height: auto`, but we can calculate the height and shim keyframes by replacing it with the\n * element's scrollHeight before the animation.\n */\nexport function shimKeyframesHeightAuto(keyframes: Keyframe[], calculatedHeight: number) {\n  return keyframes.map(keyframe => ({\n    ...keyframe,\n    height: keyframe.height === 'auto' ? `${calculatedHeight}px` : keyframe.height\n  }));\n}\n","export interface ElementAnimation {\n  keyframes: Keyframe[];\n  rtlKeyframes?: Keyframe[];\n  options?: KeyframeAnimationOptions;\n}\n\nexport interface ElementAnimationMap {\n  [animationName: string]: ElementAnimation;\n}\n\nexport interface GetAnimationOptions {\n  /**\n   * The component's directionality. When set to \"rtl\", `rtlKeyframes` will be preferred over `keyframes` where\n   * available using getAnimation().\n   */\n  dir: string;\n}\n\nconst defaultAnimationRegistry = new Map<string, ElementAnimation>();\nconst customAnimationRegistry = new WeakMap<Element, ElementAnimationMap>();\n\nfunction ensureAnimation(animation: ElementAnimation | null) {\n  return animation ?? { keyframes: [], options: { duration: 0 } };\n}\n\n//\n// Given an ElementAnimation, this function returns a new ElementAnimation where the keyframes property reflects either\n// keyframes or rtlKeyframes depending on the specified directionality.\n//\nfunction getLogicalAnimation(animation: ElementAnimation, dir: string) {\n  if (dir.toLowerCase() === 'rtl') {\n    return {\n      keyframes: animation.rtlKeyframes || animation.keyframes,\n      options: animation.options\n    };\n  }\n\n  return animation;\n}\n\n/**\n * Sets a default animation. Components should use the `name.animation` for primary animations and `name.part.animation`\n * for secondary animations, e.g. `dialog.show` and `dialog.overlay.show`. For modifiers, use `drawer.showTop`.\n */\nexport function setDefaultAnimation(animationName: string, animation: ElementAnimation | null) {\n  defaultAnimationRegistry.set(animationName, ensureAnimation(animation));\n}\n\n/** Sets a custom animation for the specified element. */\nexport function setAnimation(el: Element, animationName: string, animation: ElementAnimation | null) {\n  customAnimationRegistry.set(el, { ...customAnimationRegistry.get(el), [animationName]: ensureAnimation(animation) });\n}\n\n/** Gets an element's animation. Falls back to the default if no animation is found. */\nexport function getAnimation(el: Element, animationName: string, options: GetAnimationOptions) {\n  const customAnimation = customAnimationRegistry.get(el);\n\n  // Check for a custom animation\n  if (customAnimation?.[animationName]) {\n    return getLogicalAnimation(customAnimation[animationName], options.dir);\n  }\n\n  // Check for a default animation\n  const defaultAnimation = defaultAnimationRegistry.get(animationName);\n  if (defaultAnimation) {\n    return getLogicalAnimation(defaultAnimation, options.dir);\n  }\n\n  // Fall back to an empty animation\n  return {\n    keyframes: [],\n    options: { duration: 0 }\n  };\n}\n","/** Waits for a specific event to be emitted from an element. Ignores events that bubble up from child elements. */\nexport function waitForEvent(el: HTMLElement, eventName: string) {\n  return new Promise<void>(resolve => {\n    function done(event: Event) {\n      if (event.target === el) {\n        el.removeEventListener(eventName, done);\n        resolve();\n      }\n    }\n\n    el.addEventListener(eventName, done);\n  });\n}\n","import '../icon/icon';\nimport { animateTo, shimKeyframesHeightAuto, stopAnimations } from '../../internal/animate';\nimport { css, html } from 'lit';\nimport { customElement, property, query } from 'lit/decorators.js';\nimport { getAnimation, setDefaultAnimation } from '../../utilities/animation-registry';\nimport { LocalizeController } from '../../utilities/localize';\nimport { waitForEvent } from '../../internal/event';\nimport { watch } from '../../internal/watch';\nimport cx from 'classix';\nimport SolidElement from '../../internal/solid-element';\n\n/**\n * @summary Accordion shows a brief summary and expands to show additional content.\n * @documentation https://solid.union-investment.com/[storybook-link]/accordion\n * @status stable\n * @since 2.0\n *\n * @dependency sd-icon\n *\n * @slot - The accordion main content.\n * @slot summary - The accordion summary. Alternatively, you can use the `summary` attribute.\n * @slot expand-icon - Optional expand icon to use instead of the default. Works best with `<sd-icon>`.\n * @slot collapse-icon - Optional collapse icon to use instead of the default. Works best with `<sd-icon>`.\n *\n * @event sd-show - Emitted when the accordion opens.\n * @event sd-after-show - Emitted after the accordion opens and all animations are complete.\n * @event sd-hide - Emitted when the accordion closes.\n * @event sd-after-hide - Emitted after the accordion closes and all animations are complete.\n *\n * @csspart base - The component's base wrapper.\n * @csspart header - The header that wraps both the summary and the expand/collapse icon.\n * @csspart summary - The container that wraps the summary.\n * @csspart summary-icon - The container that wraps the expand/collapse icons.\n * @csspart content - The accordion content.\n *\n * @animation accordion.show - The animation to use when showing accordion. You can use `height: auto` with this animation.\n * @animation accordion.hide - The animation to use when hiding accordion. You can use `height: auto` with this animation.\n */\n@customElement('sd-accordion')\nexport default class SdAccordion extends SolidElement {\n  // static styles: CSSResultGroup = styles;\n\n  private readonly localize = new LocalizeController(this);\n\n  @query('[part=\"base\"]') accordion: HTMLElement;\n  @query('[part=\"header\"]') header: HTMLElement;\n  @query('[part=\"content\"]') body: HTMLElement;\n\n  /**\n   * Indicates whether or not the accordion is open. You can toggle this attribute to show and hide the accordion, or you\n   * can use the `show()` and `hide()` methods and this attribute will reflect the accordion' open state.\n   */\n  @property({ type: Boolean, reflect: true }) open = false;\n\n  /** The summary to show in the header. If you need to display HTML, use the `summary` slot instead. */\n  @property() summary: string;\n\n  firstUpdated() {\n    this.body.hidden = !this.open;\n    this.body.style.height = this.open ? 'auto' : '0';\n  }\n\n  private handleSummaryClick() {\n    this.header.focus();\n    if (this.open) {\n      this.hide();\n    } else {\n      this.show();\n    }\n  }\n\n  private handleSummaryKeyDown(event: KeyboardEvent) {\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n\n      if (this.open) {\n        this.hide();\n      } else {\n        this.show();\n      }\n    }\n\n    if (event.key === 'ArrowUp' || event.key === 'ArrowLeft') {\n      event.preventDefault();\n      this.hide();\n    }\n\n    if (event.key === 'ArrowDown' || event.key === 'ArrowRight') {\n      event.preventDefault();\n      this.show();\n    }\n  }\n\n  @watch('open', { waitUntilFirstUpdate: true })\n  async handleOpenChange() {\n    if (this.open) {\n      // Show\n      const slShow = this.emit('sd-show', { cancelable: true });\n      if (slShow.defaultPrevented) {\n        this.open = false;\n        return;\n      }\n\n      await stopAnimations(this.body);\n      this.body.hidden = false;\n\n      const { keyframes, options } = getAnimation(this, 'accordion.show', { dir: this.localize.dir() });\n      await animateTo(this.body, shimKeyframesHeightAuto(keyframes, this.body.scrollHeight), options);\n      this.body.style.height = 'auto';\n\n      this.emit('sd-after-show');\n    } else {\n      // Hide\n      const slHide = this.emit('sd-hide', { cancelable: true });\n      if (slHide.defaultPrevented) {\n        this.open = true;\n        return;\n      }\n\n      await stopAnimations(this.body);\n\n      const { keyframes, options } = getAnimation(this, 'accordion.hide', { dir: this.localize.dir() });\n      await animateTo(this.body, shimKeyframesHeightAuto(keyframes, this.body.scrollHeight), options);\n      this.body.hidden = true;\n      this.body.style.height = 'auto';\n\n      this.emit('sd-after-hide');\n    }\n  }\n\n  /** Shows the accordion. */\n  async show() {\n    if (this.open) {\n      return undefined;\n    }\n    this.open = true;\n    return waitForEvent(this, 'sd-after-show');\n  }\n\n  /** Hides the accordion */\n  async hide() {\n    if (!this.open) {\n      return undefined;\n    }\n    this.open = false;\n    return waitForEvent(this, 'sd-after-hide');\n  }\n\n  render() {\n    return html`\n      <div part=\"base\" class=\"border border-neutral-400\">\n        <header\n          part=\"header\"\n          id=\"header\"\n          class=${cx(\n            'flex text-base gap-4 font-bold items-center cursor-pointer select-none px-4 py-3 focus:focus-outline',\n            this.open ? 'bg-white text-accent hover:bg-neutral-200' : 'text-primary bg-neutral-100 hover:bg-neutral-200'\n          )}\n          role=\"button\"\n          aria-expanded=${this.open ? 'true' : 'false'}\n          aria-controls=\"content\"\n          @click=${this.handleSummaryClick}\n          @keydown=${this.handleSummaryKeyDown}\n        >\n          <slot name=\"summary\" part=\"summary\" class=\"flex flex-auto items-center \">${this.summary}</slot>\n\n          <span\n            part=\"summary-icon\"\n            class=${cx(\n              'flex flex-grow-0 flex-shrink-0 flex-auto items-center transition-all ease-in-out duration-300',\n              this.open && 'rotate-180'\n            )}\n          >\n            <slot name=\"expand-icon\" class=${cx(this.open && 'hidden')}>\n              <sd-icon library=\"system\" name=\"chevron-down\"></sd-icon>\n            </slot>\n            <slot name=\"collapse-icon\" class=${cx(!this.open && 'hidden')}>\n              <sd-icon library=\"system\" name=\"chevron-down\"></sd-icon>\n            </slot>\n          </span>\n        </header>\n        <div part=\"content\" id=\"content\" class=\"overflow-hidden\">\n          <slot class=\"block px-4 py-6\" role=\"region\" aria-labelledby=\"header\"></slot>\n        </div>\n      </div>\n    `;\n  }\n\n  static styles = [\n    SolidElement.styles,\n    css`\n      :host {\n        display: block;\n      }\n    `\n  ];\n}\n\nsetDefaultAnimation('accordion.show', {\n  keyframes: [\n    { height: '0', opacity: '0' },\n    { height: 'auto', opacity: '1' }\n  ],\n  options: { duration: 300, easing: 'ease' }\n});\n\nsetDefaultAnimation('accordion.hide', {\n  keyframes: [\n    { height: 'auto', opacity: '1' },\n    { height: '0', opacity: '0' }\n  ],\n  options: { duration: 300, easing: 'ease' }\n});\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'sd-accordion': SdAccordion;\n  }\n}\n"],"names":["animateTo","el","keyframes","options","resolve","animation","prefersReducedMotion","stopAnimations","handleAnimationEvent","shimKeyframesHeightAuto","calculatedHeight","keyframe","defaultAnimationRegistry","customAnimationRegistry","ensureAnimation","getLogicalAnimation","dir","setDefaultAnimation","animationName","getAnimation","customAnimation","defaultAnimation","waitForEvent","eventName","done","event","SdAccordion","SolidElement","LocalizeController","html","cx","css","__decorateClass","query","property","watch","customElement"],"mappings":"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"}